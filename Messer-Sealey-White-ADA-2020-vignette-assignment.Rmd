---
title: "Messer-Sealey-White-ADA-2020-vignette-assignment"
author: "BA White, BA Sealey, E Messer"
date: "5/13/2020"
output: html_document
---
## Files to Turn In: 
## 1) RMD file(1) and thus html(2) for vignette module
## 2) vignette R package (3) using 1 or more dataset and NOW 2 functions of choice 

## Vignette Assignemt Objectives:
## 1a) walk users through demonstrations of relevant analyses in module style 
## 2a) set of functions and associated function documentation appropriate to the topic you have chosen
## 2b) one or more relevant datasets (either data you have simulated or, preferably, real data), that you use in a module vignette about your chosen topic
## 2c) A vignette that walks users through relevant analyses and appropriate METADATA for your package (e.g., information on dependencies, etc.)

# Objectives
The objective of this module is to provide an overview to utilising social network analsyis in visualizing and analysing interaction data. Specifically we present 1. Tools to create and modify network diagrams, 2. methods to generate social network statsistics and make comparisons across groups... - come back here when we work out what to include...  

# Background
Networks are made up of two essential components, 'nodes' (represented by symbols) and ‘edges’ (represented by lines between the nodes). These lines typically indicate an interaction between the nodes. Usually, in the context of social networks, the nodes are individuals and the edges are some measured interactionCroft, (Croft, James & Krause, 2008). Network visualizations are called sociograms and illustrate a graphical representation of the data presented as nodes and edges. 

# Preliminaries
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse) # to enable tidying of data
library(reshape2) # to use with melt function to convert matrix to objects igraph can plot
library(igraph) # to make an igraph object ie. network visualization of matrix values. 

# more libraries etc
```

# Introduce NEW dataset 
Vipers were exposed to the presence of two "simulated" predators, where a preserved specimen of an avian flying and a predator touch were exposed to individual in treatment 1 and treatment 2, respectively. Dataset includes a matrix of similarity index of vipers antipredator display.    

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
# read in data for avian predator
v <- read.csv("vipers.csv")

# read in data for predator touch 
v <- read.csv("vipers_hook.csv")

## Please Note: you must ensure that your row names and column names are unique in your dataframes
```

# Specific question
## How similar did individual vipers move their heads in response to an aerial "attack"?
## How similar did individual vipers move their heads in response to a tactile "attack"?
## How does viper mean centrality of similarity compare between the aerial and tactile treatments? 

# Background on why people use this statistical approach
## Visual networks are used by researchers to represent connectedness between entities. They are presented as nodes (dots) that represent the unique entity or individual and edges (lines) that represent the link, connectedness, or interaction between the nodes. Here we specifically visualize an individuals snake's antipredator behavior divided by all individuals antipredator behavior as a ratio in a network of similarity. We will then determine if the centrality of the similarity ratio between two treatments, aerial and tactile, differs.  

# Analysis 
```{r}
# melting data matrix for aerial treatment
b0 <- read_csv("blacktreatments_heads2020f.csv", col_names=TRUE)
b <- select(b0, -names)
names <- as.data.frame(b0$names)
head(b)
b <- as.matrix(b)
b[lower.tri(b, diag=TRUE)] <- NA
r <- setNames(melt(b), c('ind1', 'ind2', 'values'))
head(r)
r <- filter(r, !is.na(values))
summary(r)

# melting data matirx for tactile treatment 
d <- read_csv("tactiletreatments_heads2020f.csv", col_names=TRUE)
d <- select(d, -names)
head(d)
d <- as.matrix(d)
d[lower.tri(d, diag=TRUE)] <- NA
r1 <- setNames(melt(d), c('ind1', 'ind2', 'values'))
head(r)
r1 <- filter(r1, !is.na(values))
summary(r1)
```


# Data Visualization
```{r}
# network plot of aerial treatment
p <- graph_from_data_frame(r, directed = FALSE, vertices = NULL)
plot(p, vertex.label = NA)

# network plot of tactile treatment
p1 <- graph_from_data_frame(r1, directed = FALSE, vertices = NULL)
plot(p1, vertex.label = NA)


library(visNetwork)

#trying visnetwork
nb <- 10
nodes <- data.frame(id = 1:nb, label = paste("Label", 1:nb),
 group = sample(LETTERS[1:3], nb, replace = TRUE), value = 1:nb,
 title = paste0("<p>", 1:nb,"<br>Tooltip !</p>"), stringsAsFactors = FALSE)

r1 <- data.frame(from = trunc(runif(nb)*(nb-1))+1,
 to = trunc(runif(nb)*(nb-1))+1,
 title = paste0("<p>", 1:nb,"<br>Edge Tooltip !</p>"))

head(r1)

visNetwork(nodes, r1, width = "100%") %>% 
  visEdges(arrows = 'from')

# converting igraph to visnetwork

data <- toVisNetworkData(p1)

visNetwork(nodes = data$nodes, edges = data$edges, height = "500px")

data$edges
data$nodes
class(data$nodes)

visNetwork(nodes = names$b0names, edges = data$edges, height = "500px")

visIgraph(p1) %>% 
  visOptions(manipulation = TRUE)

glimpse(p1)
```

# Our prediction is that the visualization will cluster antipredator behavior in the center - lines represent the similarity by thickness. Centrality is represented by node size. 

# Statistical Approach
# Compare similarity index between an avian flying over and being touched by a predator. 

# Inferring Results 
# Individual vipers typically behaved similarly in both treatments as expected. 

# Concept Overview 

